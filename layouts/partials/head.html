<head>
  <meta charset="utf-8">
  <title>{{ with .Title }}{{ . }}{{ else }}{{ with site.Title }}{{ . }}{{ end }}{{ end }}</title>

  {{ "<!-- mobile responsive meta -->" | safeHTML }}
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description"
    content="{{ with .Description }}{{ . }}{{ else }}{{ with site.Params.description }}{{ . }}{{ end }}{{ end }}">
  {{ with site.Params.author }}
  <meta name="author" content="{{ . }}">{{ end }}
  <!-- theme meta -->
  <meta name="theme-name" content="parsa-hugo" />
  {{ hugo.Generator }}

  {{ "<!-- geo meta -->" | safeHTML }}
  {{ with site.Params.geo.region }}
  <meta name="geo.region" content="{{ . }}">{{ end }}
  {{ with site.Params.geo.placename }}
  <meta name="geo.placename" content="{{ . }}">{{ end }}
  {{ with site.Params.geo.position }}
  <meta name="geo.position" content="{{ . }}">{{ end }}
  {{ with site.Params.geo.position }}
  <meta name="ICBM" content="{{ . }}">{{ end }}

  {{ "<!-- Google Fonts -->" | safeHTML }}
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Montserrat:wght@600;700;800;900&family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">

  {{ "<!-- plugins -->" | safeHTML }}
  {{ range site.Params.plugins.css }}
  <link rel="stylesheet" href="{{ .link | absURL }} ">
  {{ end }}

  {{ "<!-- Main Stylesheet -->" | safeHTML }}
  {{ $styles := resources.Get "css/style.css" | minify }}
  <link rel="stylesheet" href="{{ $styles.Permalink }}" media="screen">

  {{ "<!-- Custom Stylesheet (Glassmorphism) -->" | safeHTML }}
  {{ $customCSS := resources.Get "css/custom.css" }}
  {{ if $customCSS }}
    {{ if hugo.IsDevelopment }}
      <link rel="stylesheet" href="{{ $customCSS.RelPermalink }}" media="screen">
    {{ else }}
      {{ $customCSS = $customCSS | minify }}
      <link rel="stylesheet" href="{{ $customCSS.RelPermalink }}" media="screen">
    {{ end }}
  {{ end }}
  
  {{ "<!-- Additional Custom CSS from config -->" | safeHTML }}
  {{ range site.Params.custom_css }}
  <link rel="stylesheet" href="{{ . | absURL }}">
  {{ end }}

  {{ "<!--Favicon-->" | safeHTML }}
  <link rel="shortcut icon" href="{{ `images/favicon.png` | absURL }} " type="image/x-icon">
  <link rel="icon" href="{{ `images/favicon.png` | absURL }} " type="image/x-icon">

  {{ "<!-- Open Graph / Twitter -->" | safeHTML }}
  {{ $ogTitle := cond (ne .Title "") .Title site.Title }}
  {{ $ogDesc := cond (ne .Description "") .Description site.Params.description }}
  {{ $ogImage := .Params.image }}
  {{ if not $ogImage }}
  {{ with site.Params.og_image }}{{ $ogImage = . }}{{ end }}
  {{ end }}
  {{ if not $ogImage }}
  {{ with site.Params.default_image }}{{ $ogImage = . }}{{ end }}
  {{ end }}

  <meta property="og:site_name" content="{{ site.Title }}">
  <meta property="og:title" content="{{ $ogTitle }}">
  <meta property="og:description" content="{{ $ogDesc }}">
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  {{ if $ogImage }}
  <meta property="og:image" content="{{ $ogImage | absURL }}">
  {{ end }}
  {{ if .IsPage }}
  <meta property="article:section" content="{{ .Section }}">
  <meta property="article:published_time" content="{{ .PublishDate.Format " 2006-01-02T15:04:05Z07:00" }}">
  <meta property="article:modified_time" content="{{ .Lastmod.Format " 2006-01-02T15:04:05Z07:00" }}">
  {{ end }}

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ $ogTitle }}">
  <meta name="twitter:description" content="{{ $ogDesc }}">
  {{ if $ogImage }}
  <meta name="twitter:image" content="{{ $ogImage | absURL }}">
  {{ end }}

  {{ template "_internal/opengraph.html" . }}
  {{ template "_internal/google_analytics.html" . }}

  <!-- Mermaid JS -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        themeVariables: {
          fontFamily: 'Inter, system-ui, sans-serif'
        },
        flowchart: {
          useMaxWidth: true,
          htmlLabels: true
        },
        securityLevel: 'loose'
      });
    });
  </script>

  <!-- Facebook Pixel Code -->
  <script>
    !function (f, b, e, v, n, t, s) {
      if (f.fbq) return; n = f.fbq = function () {
        n.callMethod ?
        n.callMethod.apply(n, arguments) : n.queue.push(arguments)
      };
      if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
      n.queue = []; t = b.createElement(e); t.async = !0;
      t.src = v; s = b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
      'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', 'YOUR_PIXEL_ID');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=YOUR_PIXEL_ID&ev=PageView&noscript=1" /></noscript>
  <!-- End Facebook Pixel Code -->

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-YOUR_ADSENSE_ID"
    crossorigin="anonymous"></script>

  <!-- Code Copy Button Script -->
  <script src="{{ " js/code-copy.js" | absURL }}" defer></script>

</head>